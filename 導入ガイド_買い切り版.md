# 📦 QC7 つ道具システム 買い切り版 - 完全導入ガイド

## 🎯 このシステムの特徴

- ✅ **完全ローカル完結** - インターネット不要で動作
- ✅ **外部 API 不使用** - データは一切外部に送信されません
- ✅ **メンテ不要設計** - 数年後も同じ状態で動作
- ✅ **即納可能** - インストールしてすぐ使用可能

---

## 📋 必要な環境

### 推奨スペック

- **OS**: Windows 10/11, macOS 10.14 以降, Linux (Ubuntu 18.04 以降)
- **CPU**: Intel Core i3 以上 / AMD Ryzen 3 以上
- **メモリ**: 4GB 以上
- **ストレージ**: 2GB 以上
- **Python**: 3.8 以上（自動インストールされるため不要な場合あり）

### 必要なソフトウェア

- Python 3.8 以上（システムに含まれる場合あり）
- ブラウザ（Chrome, Firefox, Safari, Edge 最新版）
- Microsoft Excel または互換ソフト（Excel ファイル編集用）

---

## 🚀 インストール手順

### Windows の場合

1. **フォルダを解凍**

   ```
   QC7つ道具買い切りver をダウンロードして任意の場所に解凍
   ```

2. **システムを起動**

   - `run.bat` をダブルクリック
   - 初回のみライブラリのインストールに 5-10 分かかります

3. **ブラウザでアクセス**
   - 自動的にブラウザが開きます
   - 開かない場合は `http://localhost:8501` を開いてください

### macOS / Linux の場合

1. **ターミナルを開く**

   ```bash
   cd "/path/to/QC7つ道具買い切りver"
   ```

2. **実行権限を付与（初回のみ）**

   ```bash
   chmod +x run.sh
   ```

3. **システムを起動**

   ```bash
   ./run.sh
   ```

4. **ブラウザでアクセス**
   - ターミナルに表示される URL をコピーしてブラウザで開く
   - 通常は `http://localhost:8501` です

---

## 💡 初回起動時の注意点

### 1. ファイアウォール警告について

初回起動時に「ファイアウォールがネットワークアクセスをブロックしました」というメッセージが表示される場合があります。

- **「アクセスを許可」を選択してください**
- これはローカルホスト（localhost）への接続のみで、外部への通信は行いません

### 2. 起動に時間がかかる場合

初回起動時は以下の処理が行われます：

- 必要なライブラリのインストール（5-10 分）
- Python 仮想環境のセットアップ

2 回目以降は 1-2 分で起動します。

---

## 📊 使用方法

### データの準備

1. **データ入力テンプレートを使用**

   - `データ入力テンプレート.xlsx` を開く
   - 必要な項目を入力

2. **CSV ファイルとして保存**

   - Excel 形式でもそのまま読み込めます
   - または CSV 形式に変換

3. **システムにアップロード**
   - サイドバーからファイルを選択
   - またはドラッグ&ドロップ

### グラフの生成

1. **QC7 つ道具を選択**

   - サイドバーから分析したいツールを選択

2. **グラフを確認**

   - 自動的にグラフが生成されます

3. **画像をダウンロード**
   - 各グラフの下に「PNG 画像をダウンロード」ボタンがあります
   - クリックして画像を保存

### PDF レポートの生成

1. **プレゼン資料生成を選択**

   - サイドバーで「8. プレゼン資料生成」を選択

2. **基本情報を入力**

   - 会社名、部署名、発表者名などを入力

3. **PDF を生成**
   - 「📄 PDF 生成」ボタンをクリック
   - ダウンロードボタンで PDF を保存

---

## 🔧 トラブルシューティング

### よくある問題と解決方法

#### 1. 「Python が見つかりません」エラー

**症状**: `run.bat` または `run.sh` を実行しても起動しない

**解決方法**:

1. Python がインストールされているか確認
   - Windows: コマンドプロンプトで `python --version`
   - Mac/Linux: ターミナルで `python3 --version`
2. Python が見つからない場合：
   - [Python 公式サイト](https://www.python.org/downloads/) からダウンロード
   - インストール時に「Add Python to PATH」にチェックを入れる

#### 2. ブラウザが自動的に開かない

**症状**: ターミナルに「http://localhost:8501」と表示されるが、ブラウザが開かない

**解決方法**:

1. 手動でブラウザを開く
2. アドレスバーに `http://localhost:8501` を入力
3. または `http://127.0.0.1:8501` を試す

#### 3. 「port 8501 が既に使用されています」エラー

**症状**: システムが起動できない

**解決方法**:

1. 別のアプリケーション（別の Streamlit アプリなど）が起動している可能性があります
2. タスクマネージャー（Windows）やアクティビティモニター（Mac）でプロセスを確認
3. Python プロセスを終了して再起動

#### 4. グラフが表示されない

**症状**: グラフの部分が空白になる

**解決方法**:

1. ブラウザを最新版に更新
2. ブラウザの JavaScript が有効になっているか確認
3. 別のブラウザで試す（Chrome 推奨）

#### 5. データファイルが読み込めない

**症状**: ファイルをアップロードしてもエラーになる

**解決方法**:

1. ファイルが正しい形式か確認
   - CSV: UTF-8 エンコーディング
   - Excel: .xlsx または.xls 形式
2. 必須項目が含まれているか確認
   - 日付、製品名、不良項目、不良数、検査数
3. データに空の行や特殊文字がないか確認

---

## 📁 ファイル構成

```
QC7つ道具買い切りver/
├── app.py                          # メインアプリケーション
├── requirements.txt                # 必要なライブラリリスト
├── run.bat                         # Windows用起動スクリプト
├── run.sh                          # Mac/Linux用起動スクリプト
├── README.md                       # 基本説明書
├── 導入ガイド_買い切り版.md        # このファイル
├── クイックスタートガイド.md       # 簡易マニュアル
├── 使用方法.md                     # 詳細マニュアル
├── データ入力ガイド.md             # データ入力方法
├── サンプルデータ説明書.md         # サンプルデータの説明
├── プレゼン資料生成ガイド.md       # レポート生成方法
├── データ入力テンプレート.xlsx     # Excelテンプレート
├── sample_data.csv                 # サンプルデータ1
├── sample_data_detailed.csv        # サンプルデータ2
└── sample_data_seasonal.csv        # サンプルデータ3
```

---

## 🔐 セキュリティについて

### データの取り扱い

- ✅ **すべてのデータはローカルマシンで処理されます**
- ✅ **インターネットへの接続は不要です**
- ✅ **外部サーバーへのデータ送信は一切行いません**

### ネットワークについて

- システムは `localhost` (127.0.0.1) で動作します
- 他のコンピュータからはアクセスできません
- ファイアウォール設定により、外部からのアクセスはブロックされます

---

## 💾 バックアップについて

### 推奨バックアップ方法

1. **システムフォルダ全体をコピー**

   ```
   定期的にシステムフォルダ全体をUSBメモリや外付けHDDにコピー
   ```

2. **データファイルを別途保存**

   ```
   入力データ（CSV/Excel）は定期的にバックアップ
   ```

3. **生成した画像/PDF を保管**
   ```
   重要な分析結果は別フォルダに保管
   ```

---

## 🆘 サポート情報

### よくある質問

**Q: インターネットなしで本当に使えますか？**
A: はい。完全にローカルで動作します。初回インストール時のみインターネット接続が必要です。

**Q: Windows 以外の OS でも使えますか？**
A: Windows、Mac、Linux すべてで動作します。

**Q: 複数のパソコンで使えますか？**
A: はい。各パソコンにコピーしてインストールできます。

**Q: データはどこに保存されますか？**
A: すべてローカルマシン上です。外部サーバーには保存されません。

**Q: バージョンアップは必要ですか？**
A: 不要です。このシステムは数年後も同じ状態で動作します。

**Q: ユーザー数に制限はありますか？**
A: 制限はありません。何名でも利用できます。

---

## 📞 お問い合わせ

技術的な問題やご質問がございましたら、以下の情報をお知らせください：

- 使用している OS（Windows/Mac/Linux）
- エラーメッセージの内容
- 問題が発生した操作手順

---

**© 2024 QC7 つ道具システム 買い切り版**
